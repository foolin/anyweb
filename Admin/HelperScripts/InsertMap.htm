<html>
	<head>
		<title>插入地图</title>
		<link rel="stylesheet" type="text/css" href="editor_dialog.css">
	</style>
	</head>
	<body bgColor=menu topmargin=15 leftmargin=15 >
<FIELDSET align=left>
		<table width="100%">
			<tr>
				<td valign="top" width=650>
					<table width="100%">
						<tr>
							<td>输入您要标注的名称：<INPUT id="txtName" type="text" name="txtName" maxlength="20"><INPUT id="btnNext" type="button" value="下一步" name="btnNext" onclick="javascript:showMap();"></td>
						</tr>
						<tr>
							<td>
								<iframe id="frmMap" name="frmMap" style="WIDTH:645px;HEIGHT:485px" src="about:blank"></iframe>
							</td>
						</tr>
					</table>
				</td>
				<td width="*" valign="top"><br><br>添加地图方法：<br><br>
					1:首先输入你想在地图上标注的名称，如（"图书馆","来福餐厅","人民广场"）,名称可以是任意你想标注在地图上的地名、街道名称、机构名称等
					<BR><BR>	2:输入名称并按“下一步”后，在页面下方会显示一个地图，你可以从下拉框中选择一个地区，可以点左边的标尺改变显示比例，可以用鼠标在地图上拖动位置
					<BR><BR>
					3:当找到自己想要的位置后，点击地图上的标注按钮将会把您输入的名称标注在地图上
					<BR><BR>
					4:标注好名称后，地图自动添加入您当前编辑的文章。</td>
			</tr>
		</table>
	</body>
	<script language=javascript>
	function showMap()
	{
		var name = document.getElementById("txtName").value;
		
		if( name == "")
		{
			alert("请输入一个名称");
			document.getElementById("txtName").focus();
			return;
		}

		document.getElementById("frmMap").src = "http://club.mapbar.com/center/client/anyp/markPoi.jsp?name=" + name + "&returnurl=" + UrlEncode(document.location.href.toLowerCase().replace("insertmap.htm","receivemap.htm"));
	}
	
	function insertMap(url)
	{
		if(url=="")
		{
			window.returnValue = '';
		}
		else
		{
			if( url.toLowerCase().indexOf("http") == -1)
				url = "http://club.mapbar.com/" + url;
			window.returnValue = '<img src="'+url+'">';
		}
		window.close();
	}
function UrlEncode(str){
 var i,c,ret="",strSpecial="!\"#$%&'()*+,/:;<=>?@[\]^`{|}~%";
 for(i=0;i<str.length;i++){
  if(str.charCodeAt(i)>=0x4e00){
   c=qswhU2GB[str.charCodeAt(i)-0x4e00];
   ret+="%"+c.slice(0,2)+"%"+c.slice(-2);
  }
  else{
   c=str.charAt(i);
   if(c==" ")
    ret+="+";
   else if(strSpecial.indexOf(c)!=-1)
    ret+="%"+str.charCodeAt(i).toString(16);
   else
    ret+=c;
  }
 }
return ret;
}
</script>

	
</html>
